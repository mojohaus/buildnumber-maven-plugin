<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src/site/apt/usage.apt.vm at 2022-05-21
 | Rendered using Apache Maven Fluido Skin 1.9
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>Build Number Maven Plugin &#x2013; Usage</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.9.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.9.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <a href="https://github.com/mojohaus/buildnumber-maven-plugin">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"
        alt="Fork me on GitHub">
    </a>
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><a href="../" id="bannerLeft"><img src="../images/mojo_logo.png"  alt="MojoHaus"/></a></div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
      <li class=""><a href="../" title="MojoHaus">MojoHaus</a><span class="divider">/</span></li>
      <li class=""><a href="../mojo-parent" title="MojoHaus Parent">MojoHaus Parent</a><span class="divider">/</span></li>
      <li class=""><a href="index.html" title="Build Number Maven Plugin">Build Number Maven Plugin</a><span class="divider">/</span></li>
    <li class="active ">Usage <a href="https://github.com/mojohaus/buildnumber-maven-plugin/src/site/apt/usage.apt.vm"><img src="./images/accessories-text-editor.png" title="Edit" /></a></li>
        <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2022-05-21</li>
          <li id="projectVersion" class="pull-right"><span class="divider">|</span>Version: 3.1.0-SNAPSHOT</li>
      <li class="pull-right"><a href="https://maven.apache.org/" class="externalLink" title="Maven">Maven</a></li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li><a href="index.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li><a href="plugin-info.html" title="Goals"><span class="none"></span>Goals</a></li>
    <li class="active"><a href="#"><span class="none"></span>Usage</a></li>
    <li><a href="faq.html" title="FAQ"><span class="none"></span>FAQ</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
<form id="search-form" action="https://www.google.com/search" method="get" >
  <input value="www.mojohaus.org" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script>asyncJs( 'https://cse.google.com/brand?form=search-form' )</script>
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<section>
<h2><a name="Usage"></a>Usage</h2>
<p>This plugin works in one of 3 ways: with an SCM, with a sequential build number, or with a timestamp.</p>
<p>No matter which method you choose, you must include it in your pom:</p>
<div class="source"><pre class="prettyprint">  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
        &lt;artifactId&gt;buildnumber-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;3.1.0-SNAPSHOT&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;phase&gt;validate&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;create&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
        &lt;configuration&gt;
          &lt;doCheck&gt;true&lt;/doCheck&gt;
          &lt;doUpdate&gt;true&lt;/doUpdate&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;</pre></div>
<p>This will cause the create goal of the buildNumber plugin to be executed during the validate phase. It will first check to see if you have locally modified files, and will fail if there are any. You can suppress this behaviour with <code>-Dmaven.buildNumber.doCheck=false</code> (or remove/change the configuration info).</p>
<p>The buildNumber plugin will then update your local repository. This is done because local revision might not be the same locally as the last one on some remote server (example for svn: 'svn info' grabs the revision out of your local repository, and is not necessarily the same as the revision in the remote repository). You should probably deal with these changes before creating a build in any case. Again, this behaviour can be suppressed with <code>-Dmaven.buildNumber.doUpdate=false</code>.</p>
<p>You then need to do something with the revision provided by the plugin. The revision number is available using <code>${buildNumber}</code> in your pom. For example:</p>
<div class="source"><pre class="prettyprint">  &lt;build&gt;
    &lt;finalName&gt;$\{project.artifactId}-$\{project.version}-r$\{buildNumber}&lt;/finalName&gt;
  &lt;/build&gt;</pre></div>
<p>or to place in the manifest (META-INF/MANIFEST.mf) of your jar:</p>
<div class="source"><pre class="prettyprint">  &lt;build&gt;
    ...
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;
        &lt;version&gt;3.0.2&lt;/version&gt;
        &lt;configuration&gt;
          &lt;archive&gt;
            &lt;manifest&gt;
              &lt;addDefaultImplementationEntries&gt;true&lt;/addDefaultImplementationEntries&gt;
            &lt;/manifest&gt;
            &lt;manifestEntries&gt;
              &lt;Implementation-Build&gt;${buildNumber}&lt;/Implementation-Build&gt;
            &lt;/manifestEntries&gt;
          &lt;/archive&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;</pre></div>
<p>or war:</p>
<div class="source"><pre class="prettyprint">  &lt;build&gt;
    ...
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;
        &lt;version&gt;3.0.0&lt;/version&gt;
        &lt;configuration&gt;
          &lt;archive&gt;
            &lt;manifest&gt;
              &lt;addDefaultImplementationEntries&gt;true&lt;/addDefaultImplementationEntries&gt;
            &lt;/manifest&gt;
            &lt;manifestEntries&gt;
              &lt;Implementation-Build&gt;${buildNumber}&lt;/Implementation-Build&gt;
            &lt;/manifestEntries&gt;
          &lt;/archive&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;</pre></div>
<p>The <code>${scmBranch}</code> property is also populated to provide the SCM branch.</p>
<p><b>Note:</b> Older version of the jar and war plugin don't require the manifest/addDefaultImplementationEntries element, and in fact will fail if present. The new versions require this element.</p>
<p>You can also configure the plugin to be more flexible.</p>
<div class="source"><pre class="prettyprint">  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
        &lt;artifactId&gt;buildnumber-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;3.1.0-SNAPSHOT&lt;/version&gt;
        &lt;configuration&gt;
          &lt;format&gt;At {1,time} on {1,date}, there was {2} on planet {0,number,integer}.&lt;/format&gt;
          &lt;items&gt;
            &lt;item implementation=&quot;java.lang.Integer&quot;&gt;7&lt;/item&gt;
            &lt;item&gt;timestamp&lt;/item&gt;
            &lt;item&gt;a disturbance in the Force&lt;/item&gt;
          &lt;/items&gt;
        &lt;/configuration&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;phase&gt;validate&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;create&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;</pre></div>
<p>Other more useful configurations might be:</p>
<div class="source"><pre class="prettyprint">    &lt;configuration&gt;
      &lt;format&gt;{0,number}.{1,number}.{2,number}&lt;/format&gt;
      &lt;items&gt;
        &lt;item&gt;buildNumber0&lt;/item&gt;
        &lt;item&gt;buildNumber1&lt;/item&gt;
        &lt;item&gt;buildNumber2&lt;/item&gt;
      &lt;/items&gt;
    &lt;/configuration&gt;</pre></div>
<p>or:</p>
<div class="source"><pre class="prettyprint">    &lt;configuration&gt;
      &lt;format&gt;yyyy-MM-dd HH:mm:ss&lt;/format&gt;
      &lt;items&gt;
        &lt;item&gt;timestamp&lt;/item&gt;
      &lt;/items&gt;
    &lt;/configuration&gt;</pre></div>
<p>The plugin simply uses the <a class="externalLink" href="http://java.sun.com/j2se/1.4.2/docs/api/java/text/MessageFormat.html"> MessageFormat class</a> to produce <code>${buildNumber}</code>, and thus the above configurations would produce:</p>
<div class="source"><pre class="prettyprint">    At 12:30 PM on Jul 3, 2053, there was a disturbance in the Force on planet 7.</pre></div>
<p>and</p>
<div class="source"><pre class="prettyprint">    2.0.3</pre></div>
<p>and</p>
<div class="source"><pre class="prettyprint">    2005-10-06 2:22:55</pre></div>
<p>respectively.</p>
<p>When you specify the special items of &quot;buildNumber\d*&quot; or &quot;timestamp&quot;, then some magic is performed. For each unique buildNumber, a properties file ( see <a href="./create-mojo.html#buildNumberPropertiesFileLocation">buildNumberPropertiesFileLocation</a> ) will be created (or read if it exists) which holds an integer, starting at 1. That number will be incremented on each access. Of course, the given example is somewhat non-sensical, since it will increment all 3 numbers on each build, but it shows the type of flexibility available. For each timestamp, you simply get the current date and time.</p>
<p>Here is some additional writeup on <a class="externalLink" href="http://apollo.ucalgary.ca/tlcprojectswiki/index.php/Public/Project_Versioning_-_Best_Practices#Build_Versioning"> how to version your projects with this plugin</a>. It even details how to access the version number in your code.</p><section>
<h3><a name="Git_short_revision_ID"></a>Git short revision ID</h3>
<p>From the version 1.1 you can specify the length for the Git revision. To enable this feature you have to specify the new tag <b> &lt;shortRevisionLength&gt; </b> in the <b> &lt;configuration&gt; </b> section. For exemple:</p>
<div class="source"><pre class="prettyprint">    &lt;configuration&gt;
       &lt;shortRevisionLength&gt;5&lt;/shortRevisionLength&gt;
    &lt;/configuration&gt;</pre></div>
<p>the output of the found git revision will have only 5 characters:</p>
<div class="source"><pre class="prettyprint">    instead of b0c1c69be579175e63eeb1c056d607f01ab61e96 you will have only b0c1c</pre></div>
<p><b>Note:</b> this feature uses internally the <b>git rev-parse --short</b> command and the revision length is set to minimum 4 characters. So you can't have the revision id shorter then 4 characters. Even if you specify the length between 0 and 4, the plugin will inform you about this situation and the minimum value (4) will be used.</p></section><section>
<h3><a name="Using_svnjava_provider"></a>Using svnjava provider</h3>
<p>If you need to execute the plugin on machine without any svn in the path you can configure the mojo to use the svnjava provider.</p>
<p>NOTE the svnjava provider use the svnjava scm provider implementation <a class="externalLink" href="https://github.com/olamy/maven-scm-provider-svnjava">maven-scm-provider-svnjava</a> which rely on svnkit version.</p>
<div class="source"><pre class="prettyprint">  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
        &lt;artifactId&gt;buildnumber-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;3.1.0-SNAPSHOT&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;phase&gt;validate&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;create&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
        &lt;configuration&gt;
          &lt;doCheck&gt;true&lt;/doCheck&gt;
          &lt;doUpdate&gt;true&lt;/doUpdate&gt;
          &lt;providerImplementations&gt;
            &lt;svn&gt;javasvn&lt;/svn&gt;
          &lt;/providerImplementations&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;</pre></div></section><section>
<h3><a name="Using_Perforce_P4Maven_provider"></a>Using Perforce P4Maven provider</h3>
<p>To use this plugin with <a class="externalLink" href="https://swarm.workshop.perforce.com/files/guest/dantran/p4maven">Perforce P4Maven Provider</a>, add p4maven-provider to dependencies list.</p>
<div class="source"><pre class="prettyprint">  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
        &lt;artifactId&gt;buildnumber-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;3.1.0-SNAPSHOT&lt;/version&gt;
        &lt;dependencies&gt;
          &lt;dependency&gt;
            &lt;groupId&gt;com.perforce.p4maven&lt;/groupId&gt;
            &lt;artifactId&gt;p4maven-provider&lt;/artifactId&gt;
            &lt;version&gt;${p4maven.version}&lt;/version&gt;
          &lt;/dependency&gt;
        &lt;/dependencies&gt;
        [...]
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;</pre></div></section><section>
<h3><a name="Create_Build_Metadata"></a>Create Build Metadata</h3>
<p>For quick quick discovery of a SCM revision of an snapshot/release artifact available at maven repository, use buildnumber:create-metadata to deploy a build metadata file associate with a specific artifact of the same project.</p>
<div class="source"><pre class="prettyprint">  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
        &lt;artifactId&gt;buildnumber-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;3.1.0-SNAPSHOT&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;phase&gt;generate-resources&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;create-metadata&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
        &lt;configuration&gt;
          &lt;attach&gt;true&lt;/attach&gt;
          &lt;!--make it available for jar/war classpath resource --&gt;
          &lt;addOutputDirectoryToResources&gt;true&lt;/addOutputDirectoryToResources&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;</pre></div></section></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2007&#x2013;2022
<a href="https://www.mojohaus.org">MojoHaus</a>
</p>
        </div>
    <div id="ohloh" class="pull-right">
      <script src="https://www.ohloh.net/p/5211/widgets/project_thin_badge.js"></script>
    </div>
        </div>
    </footer>
  </body>
</html>